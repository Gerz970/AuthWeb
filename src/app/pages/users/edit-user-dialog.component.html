<div class="edit-user-dialog">
  <mat-dialog-content class="py-8 px-12 bg-white">
    <form [formGroup]="form" class="space-y-6">
      <!-- ID del Usuario -->
      <div class="input-group">
        <label class="input-label">ID del Usuario</label>
        <div class="input-container">
          <mat-icon class="input-icon">fingerprint</mat-icon>
          <input 
            type="text" 
            formControlName="id" 
            readonly 
            class="custom-input"
            placeholder="ID del usuario">
        </div>
        <span class="input-hint">Identificador único del usuario</span>
      </div>

      <!-- Nombre Completo -->
      <div class="input-group">
        <label class="input-label">Nombre Completo</label>
        <div class="input-container">
          <mat-icon class="input-icon">person</mat-icon>
          <input 
            type="text" 
            formControlName="fullName" 
            class="custom-input"
            placeholder="Nombre completo">
        </div>
        <span class="input-error" *ngIf="form.get('fullName')?.hasError('required')">
          El nombre es requerido
        </span>
      </div>

      <!-- Email -->
      <div class="input-group">
        <label class="input-label">Email</label>
        <div class="input-container">
          <mat-icon class="input-icon">email</mat-icon>
          <input 
            type="email" 
            formControlName="email" 
            class="custom-input"
            placeholder="Email">
        </div>
        <span class="input-error" *ngIf="form.get('email')?.hasError('required')">
          El email es requerido
        </span>
        <span class="input-error" *ngIf="form.get('email')?.hasError('email')">
          Ingrese un email válido
        </span>
      </div>

      <!-- Teléfono -->
      <div class="input-group">
        <label class="input-label">Teléfono</label>
        <div class="input-container">
          <mat-icon class="input-icon">phone</mat-icon>
          <input 
            type="tel" 
            formControlName="phoneNumber" 
            class="custom-input"
            placeholder="Teléfono (opcional)">
        </div>
        <span class="input-hint">Número de teléfono opcional</span>
      </div>

      <!-- Roles -->
      <div class="input-group">
        <label class="input-label">Roles</label>
        <div class="input-container">
          <mat-icon class="input-icon">security</mat-icon>
          <select 
            formControlName="roles" 
            multiple 
            [disabled]="isLoadingRoles"
            class="custom-select">
            @if (isLoadingRoles) {
              <option disabled>
                Cargando roles...
              </option>
            } @else {
              @for (role of availableRoles; track role.id) {
                <option [value]="role.name">
                  {{ role.name }} ({{ role.totalUsers }} usuarios)
                </option>
              }
            }
          </select>
        </div>
        <span class="input-error" *ngIf="form.get('roles')?.hasError('required')">
          Al menos un rol es requerido
        </span>
      </div>

      <!-- Current Roles Display -->
      @if (data.user.roles.length > 0) {
        <div class="mt-6 p-6 bg-gray-50 rounded-xl border border-gray-200">
          <label class="text-sm font-semibold text-gray-700 mb-4 block">Roles Actuales:</label>
          <div class="flex flex-wrap gap-3">
            @for (role of data.user.roles; track role) {
              <span class="role-chip">
                {{ role }}
              </span>
            }
          </div>
        </div>
      }
    </form>
  </mat-dialog-content>

  <div class="bg-gray-50 px-12 py-6 rounded-b-xl border-t border-gray-200">
    <mat-dialog-actions align="end" class="gap-6">
      <button mat-button (click)="onCancel()" [disabled]="isSubmitting" class="cancel-btn">
        <mat-icon>close</mat-icon>
        Cancelar
      </button>
      <button 
        mat-raised-button 
        color="primary" 
        (click)="onSubmit()" 
        [disabled]="!form.valid || isSubmitting"
        class="submit-btn">
        <mat-icon>save</mat-icon>
        @if (isSubmitting) {
          <mat-spinner diameter="20" class="mr-2"></mat-spinner>
          Actualizando...
        } @else {
          Actualizar Usuario
        }
      </button>
    </mat-dialog-actions>
  </div>
</div> 