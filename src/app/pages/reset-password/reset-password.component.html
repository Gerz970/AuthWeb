<div class="h-screen flex items-center justify-center">
  <div class="shadow-md rounded-md p-8 bg-white w-96">
    <div class="py-4 text-center">
      <h1 class="font-bold py-2 text-2xl">
        Cambiar Contraseña
      </h1>
      <h6 class="text-slate-600 text-base">
        Ingresa tu nueva contraseña
      </h6>
    </div>

    <form [formGroup]="form" (ngSubmit)="submitResetPassword()">
      <!-- Campo oculto para el token -->
      <input type="hidden" formControlName="token" />
      
      <mat-form-field appearance="fill" class="w-full">
        <mat-label>Correo Electrónico</mat-label>
        <input matInput placeholder="tu@email.com" formControlName="email" readonly />
        <mat-icon matPrefix>email</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="fill" class="w-full">
        <mat-label>Nueva Contraseña</mat-label>
        <input 
          matInput 
          type="{{ hidePassword ? 'password' : 'text'}}" 
          formControlName="newPassword" 
          placeholder="Nueva contraseña" />
        <mat-icon matPrefix>lock</mat-icon>
        <mat-icon (click)="hidePassword = !hidePassword" matSuffix>
          {{ hidePassword ? 'visibility_off':'visibility'}}
        </mat-icon>
      </mat-form-field>

      <mat-form-field appearance="fill" class="w-full">
        <mat-label>Confirmar Contraseña</mat-label>
        <input 
          matInput 
          type="{{ hideConfirmPassword ? 'password' : 'text'}}" 
          formControlName="confirmPassword" 
          placeholder="Confirmar contraseña" />
        <mat-icon matPrefix>lock</mat-icon>
        <mat-icon (click)="hideConfirmPassword = !hideConfirmPassword" matSuffix>
          {{ hideConfirmPassword ? 'visibility_off':'visibility'}}
        </mat-icon>
      </mat-form-field>

      <div *ngIf="form.errors?.['passwordMismatch'] && form.get('confirmPassword')?.touched" 
           class="text-red-500 text-sm mb-4">
        Las contraseñas no coinciden
      </div>

      <div *ngIf="form.get('newPassword')?.invalid && form.get('newPassword')?.touched" 
           class="text-red-500 text-sm mb-4">
        <div *ngIf="form.get('newPassword')?.errors?.['required']">La contraseña es requerida</div>
        <div *ngIf="form.get('newPassword')?.errors?.['minlength']">La contraseña debe tener al menos 6 caracteres</div>
      </div>

      <div *ngIf="form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched" 
           class="text-red-500 text-sm mb-4">
        <div *ngIf="form.get('confirmPassword')?.errors?.['required']">Confirma tu contraseña</div>
      </div>

      <!-- Debug info (solo para desarrollo) -->
      <div *ngIf="token" class="text-xs text-gray-500 mb-4 p-2 bg-gray-100 rounded">
        <strong>Debug:</strong> Token recibido ({{token.length}} caracteres)
      </div>

      <button 
        type="submit" 
        [disabled]="!form.valid || isLoading"
        class="w-full border border-slate-200 rounded-md disabled:bg-purple-400 py-2 px-3 bg-purple-700 text-white font-bold mb-4">
        <span *ngIf="!isLoading">Cambiar Contraseña</span>
        <span *ngIf="isLoading">Cambiando...</span>
      </button>
    </form>

    <div class="text-center">
      <span class="text-slate-600">
        ¿Recordaste tu contraseña?
      </span>
      <a class="text-purple-700 ml-1" [routerLink]="['/login']">Volver al Login</a>
    </div>
  </div>
</div> 